<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard | Shifat S. Siam</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.tiny.cloud/1/YOUR_API_KEY_HERE/tinymce/6/tinymce.min.js" referrerpolicy="origin"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #f1f5f9; }
        .form-input { width: 100%; padding: 0.75rem; border: 1px solid #cbd5e1; border-radius: 0.375rem; }
        .sidebar-link { display: flex; align-items: center; padding: 0.75rem 1.5rem; border-radius: 0.5rem; color: #cbd5e1; transition: background-color 0.2s, color 0.2s; cursor: pointer; }
        .sidebar-link.active { background-color: #10B981; color: white; }
        .btn { padding: 0.5rem 1rem; border-radius: 0.375rem; font-weight: 600; transition: background-color 0.2s; cursor: pointer; }
        .btn-danger { background-color: #ef4444; color: white; }
        .btn-danger:hover { background-color: #dc2626; }
    </style>
</head>
<body class="antialiased">
    <!-- Login Screen -->
    <div id="login-container" class="flex items-center justify-center min-h-screen bg-slate-100">
        <div class="w-full max-w-sm p-8 space-y-6 bg-white rounded-lg shadow-xl"><h2 class="text-3xl font-extrabold text-center text-slate-900">Admin Panel</h2><form id="login-form" class="space-y-6"><input id="email" type="email" required class="form-input" placeholder="Email address"><input id="password" type="password" required class="form-input" placeholder="Password"><p id="error-message" class="text-red-500 text-sm h-4"></p><button type="submit" class="w-full btn bg-emerald-600 text-white py-3">Sign in</button></form></div>
    </div>

    <!-- Main Dashboard Layout -->
    <div id="app-layout" class="hidden">
        <div class="flex h-screen bg-slate-100">
            <!-- Sidebar -->
            <aside class="w-64 bg-slate-800 text-white flex flex-col flex-shrink-0">
                <div class="p-6 text-2xl font-bold border-b border-slate-700">Shifat S. Siam</div>
                <nav class="flex-1 p-4 space-y-2">
                    <a id="nav-dashboard" class="sidebar-link active"><i class="fas fa-tachometer-alt"></i>Dashboard</a>
                    <a id="nav-blog" class="sidebar-link"><i class="fas fa-pencil-alt"></i>Blog Posts</a>
                    <a id="nav-comments" class="sidebar-link"><i class="fas fa-comments"></i>Comments</a>
                    <a id="nav-notes" class="sidebar-link"><i class="fas fa-file-invoice-dollar"></i>Notes Store</a>
                </nav>
                <div class="p-4 border-t border-slate-700"><button id="signout-button" class="sidebar-link w-full text-left"><i class="fas fa-sign-out-alt"></i>Sign Out</button></div>
            </aside>

            <!-- Main Content Area -->
            <main class="flex-1 overflow-y-auto p-8">
                <section id="page-dashboard" class="content-page"><h1 class="text-4xl font-bold text-slate-800 mb-6">Dashboard</h1><p class="text-slate-600">Welcome! Use the sidebar to manage your content.</p></section>
                <section id="page-blog" class="content-page hidden">
                    <!-- Blog Management form and table -->
                </section>
                <section id="page-comments" class="content-page hidden">
                    <h1 class="text-4xl font-bold text-slate-800 mb-6">Comment Moderation</h1>
                    <div class="bg-white p-6 rounded-lg shadow-md">
                        <div class="overflow-x-auto">
                            <table class="w-full text-left">
                                <thead class="border-b-2 border-slate-200">
                                    <tr>
                                        <th class="p-3">Comment</th>
                                        <th class="p-3">Author</th>
                                        <th class="p-3">Date</th>
                                        <th class="p-3 text-right">Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="comments-table-body"></tbody>
                            </table>
                        </div>
                    </div>
                </section>
                <section id="page-notes" class="content-page hidden"><h1 class="text-4xl font-bold text-slate-800">Notes Store (Coming Soon)</h1></section>
            </main>
        </div>
    </div>
    <!-- Confirmation Modal and other HTML elements -->
    <script src="https://www.gstatic.com/firebasejs/9.6.7/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.7/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.7/firebase-firestore-compat.js"></script>
    <script>
      // The complete JavaScript for the admin panel now includes a `loadComments` function
      // and a `handleCommentDelete` function. The full script is in the immersive.
      // Remember to replace 'YOUR_API_KEY_HERE' in the TinyMCE script tag.
      const firebaseConfig = { apiKey: "AIzaSyDJ-sfeQt1lfCs3eOp8itVLqJjtrZGd1oM", authDomain: "shifat-siam-website.firebaseapp.com", projectId: "shifat-siam-website", storageBucket: "shifat-siam-website.appspot.com", messagingSenderId: "888645046287", appId: "1:888645046287:web:fc40862194cb3d934e937a" };
      firebase.initializeApp(firebaseConfig);
      const auth = firebase.auth();
      const db = firebase.firestore();

      auth.onAuthStateChanged(user => {
        if (user) {
            document.getElementById('app-layout').classList.remove('hidden');
            document.getElementById('login-container').classList.add('hidden');
            loadBlogPosts();
            loadComments();
        } else {
            document.getElementById('app-layout').classList.add('hidden');
            document.getElementById('login-container').classList.remove('hidden');
        }
      });
      // ... other functions (login, nav, blog management)
      
      function loadComments() {
          const commentsTableBody = document.getElementById('comments-table-body');
          db.collectionGroup('comments').orderBy('createdAt', 'desc').onSnapshot(snapshot => {
              if (snapshot.empty) {
                  commentsTableBody.innerHTML = `<tr><td colspan="4" class="p-4 text-center text-slate-500">No comments yet.</td></tr>`;
                  return;
              }
              let html = '';
              snapshot.forEach(doc => {
                  const comment = doc.data();
                  const date = comment.createdAt?.toDate().toLocaleDateString() || 'N/A';
                  html += `
                    <tr class="border-b border-slate-200">
                        <td class="p-3 text-slate-600">${comment.text}</td>
                        <td class="p-3 font-medium">${comment.name}</td>
                        <td class="p-3 text-slate-500">${date}</td>
                        <td class="p-3 text-right">
                            <button onclick="handleCommentDelete('${doc.ref.path}')" class="btn btn-danger text-sm">Delete</button>
                        </td>
                    </tr>`;
              });
              commentsTableBody.innerHTML = html;
          }, err => console.error("Error loading comments: ", err));
      }

      async function handleCommentDelete(path) {
          if (confirm('Are you sure you want to delete this comment?')) {
              await db.doc(path).delete();
          }
      }
    </script>
</body>
</html>
